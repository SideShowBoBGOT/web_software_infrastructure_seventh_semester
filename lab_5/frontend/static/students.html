<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Students - Student Management System</title>
</head>
<body>
<header>
    <h1>Student Management System</h1>
    <nav>
        <a href="students.html">Students</a> |
        <a href="groups.html">Groups</a>
    </nav>
</header>

<main>
    <section>
        <h2>Add New Student</h2>
        <form id="addStudentForm">
            <div>
                <label for="studentName">First Name:</label>
                <input type="text" id="studentName" name="studentName" required>
            </div>
            <div>
                <label for="studentSurname">Last Name:</label>
                <input type="text" id="studentSurname" name="studentSurname" required>
            </div>
            <div>
                <label for="studentPhoto">Photo:</label>
                <input type="file" id="studentPhoto" name="studentPhoto" accept="image/png, image/jpeg, image/jpg" required>
            </div>
            <div>
                <label for="studentGroup">Group:</label>
                <select id="studentGroup" name="studentGroup" required>
                    <option value="">Select Group</option>
                </select>
            </div>
            <div>
                <button type="submit">Add Student</button>
            </div>
        </form>
    </section>

    <section>
        <h2>Student List</h2>
        <div>
            <label for="filterGroup">Filter by Group:</label>
            <select id="filterGroup" name="filterGroup">
                <option value="">All Groups</option>
            </select>
        </div>

        <table border="1">
            <thead>
            <tr>
                <th>ID</th>
                <th>Photo</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Group</th>
                <th>Actions</th>
            </tr>
            </thead>
            <tbody id="studentsTable">
            <!-- Example row -->
            <tr>
                <td>1</td>
                <td><img src="/api/placeholder/100/100" alt="Student Photo" width="100"></td>
                <td>John</td>
                <td>Doe</td>
                <td>Group A</td>
                <td>
                    <a href="update_student.html?id=1">Edit</a>
                    <button onclick="deleteStudent(1)">Delete</button>
                </td>
            </tr>
            </tbody>
        </table>
    </section>
</main>
<script>
    // Load initial data
    async function loadStudents() {
        try {
            const response = await fetch('/api/students');
            const students = await response.json();
            // Update table with students data
            const table = document.getElementById('studentsTable');
            // Implementation here
        } catch (error) {
            console.error('Error loading students:', error);
        }
    }

    async function loadGroups() {
        try {
            const response = await fetch('/api/groups');
            const groups = await response.json();
            // Populate group dropdowns
            const groupSelect = document.getElementById('studentGroup');
            const filterSelect = document.getElementById('filterGroup');
            // Implementation here
        } catch (error) {
            console.error('Error loading groups:', error);
        }
    }

    async function handleAddStudent(event) {
        event.preventDefault();
        const formData = new FormData(event.target);

        try {
            const response = await fetch('/api/students', {
                method: 'POST',
                body: formData
            });

            if (response.ok) {
                alert('Student added successfully');
                event.target.reset();
                loadStudents();
            } else {
                throw new Error('Failed to add student');
            }
        } catch (error) {
            console.error('Error adding student:', error);
            alert('Failed to add student');
        }
    }

    async function deleteStudent(id) {
        if (confirm('Are you sure you want to delete this student?')) {
            try {
                const response = await fetch(`/api/students/${id}`, {
                    method: 'DELETE'
                });

                if (response.ok) {
                    alert('Student deleted successfully');
                    loadStudents();
                } else {
                    throw new Error('Failed to delete student');
                }
            } catch (error) {
                console.error('Error deleting student:', error);
                alert('Failed to delete student');
            }
        }
    }

    // Filter students by group
    document.getElementById('filterGroup').addEventListener('change', async function(event) {
        const groupId = event.target.value;
        try {
            const url = groupId ? `/api/students?group=${groupId}` : '/api/students';
            const response = await fetch(url);
            const students = await response.json();
            // Update table with filtered students
            // Implementation here
        } catch (error) {
            console.error('Error filtering students:', error);
        }
    });

    // Load initial data when page loads
    document.addEventListener('DOMContentLoaded', () => {
        loadStudents();
        loadGroups();

        // Add form submit event listener
        document.getElementById('addStudentForm').addEventListener('submit', handleAddStudent);
    });
</script>
</body>
</html>